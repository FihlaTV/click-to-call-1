{"version":3,"file":"static/webpack/static/development/pages/preview.js.0fab23d9c5e7b80e0515.hot-update.js","sources":["webpack:///./components/PreviewCampaignItem.js"],"sourcesContent":["import React, { Component } from \"react\";\nimport gql from \"graphql-tag\";\nimport Router from \"next/router\";\nimport { useRouter } from 'next/router';\n\nimport { Query } from \"react-apollo\";\nimport Error from \"./ErrorMessage\";\nimport styled from \"styled-components\";\nimport Head from \"next/head\";\nimport Link from \"next/link\";\nimport MainStyles from \"./styles/MainStyles\";\nimport MatchedScripts from \"./MatchedScripts\";\nimport { FetchType } from \"apollo-client\";\n\n\nconst SINGLE_CAMPAIGN_ITEM_QUERY = gql`\n  query SINGLE_CAMPAIGN_ITEM_QUERY($id: ID!) {\n    campaignItem(where: { id: $id }) {\n      id\n      title\n      connectKey\n      customURL\n      targetType\n      dynamicScripts\n      generateURLAlias\n      expiration\n      callBody\n      defaultScript\n      targetCandidates\n      thankYouTitle\n      thankYouMessage\n      emailTitle\n      emailBody\n      facebookTitle\n      facebookURL\n      facebookBody\n      facebookImage\n      twitterTitle\n      twitterURL\n      twitterBody\n      twitterImage\n    }\n  }\n`;\n\n\nclass PreviewCampaignItem extends Component {\n\n  state = {\n    error: null,\n    isLoaded: false,\n    streetAddress: '',\n    postalCode: '',\n    officeItems: [],\n    officialItems: [],\n    divisionItems: [],\n    candidateParty: '',\n    candidateState: ''\n  };\n\n  handleChange = e => {\n    const { name, type, value } = e.target;\n    const val = type === \"number\" ? parseFloat(value) : value;\n    this.setState({ [name]: val });\n    console.log(this.state);\n  };\n\n  connectSubmit = async e => {\n    e.preventDefault();\n    const data = new FormData(e.target);\n\n    const res = await fetch(\"https://secure.mcommons.com/profiles/join\", {\n      method: \"POST\",\n      body: data\n    });\n\n    const fetchdata = await fetch(\"https://www.googleapis.com/civicinfo/v2/representatives?key=AIzaSyBZJiENz59YA6HdE9fbqdrAYPmayg9i61I&address=\"+encodeURI(this.state.streetAddress)+\"+\"+this.state.postalCode)\n      .then(res => res.json());\n\n      // console.log(fetchdata.offices[3].divisionId);\n\n\n\n      if(fetchdata.officials[0]) {\n        this.setState({\n          isLoaded: true,\n          officeItems: fetchdata.offices,\n          officialItems: fetchdata.officials[4].name,\n          divisionItems: fetchdata.divisions,\n          candidateParty: fetchdata.officials[4].party,\n          candidateState: fetchdata.normalizedInput.state\n        });\n      } else {\n        (error) => {\n          this.setState({\n            isLoaded: true,\n            error\n          });\n        }\n      }\n\n\n\n\n    this.setState({ shouldHide: true });\n    this.setState({ shouldHide2: true });\n    this.setState({ shouldHide3: false });\n\n  }\n\n\n  componentDidMount = e => {\n    console.log(this.props.id);\n    // Router.push('/custom-url', { shallow: true })\n\n    var str = \"ocd-division/country:us/state:va/cd:2\";\n    var res = str.split(\"/cd:\");\n    var res2 = res[0].split(\"/state:\");\n    console.log(res[1]);\n    console.log(res2[1]);\n\n\n  }\n\n\n  render() {\n\n\n\n    return (\n\n      <Query\n        query={SINGLE_CAMPAIGN_ITEM_QUERY}\n        variables={{ id: this.props.id }}\n      >\n        {({ data, loading, error }) => {\n          if (loading) return <p>Loading...</p>;\n          console.log(data.campaignItem);\n          if(data.campaignItem.expiration === 'false') {\n            return (\n              <MainStyles>\n                <p className=\"expired\">This campaign has expired.</p>\n              </MainStyles>\n\n            );\n          } else {\n\n          return (\n            <div className=\"frontEndPage\">\n              <Error error={error} />\n              <MainStyles>\n                <Head>\n                  <title>{data.campaignItem.title}</title>\n                  <meta\n                    property=\"og:site_name\"\n                    content=\"Indivisible\"\n                  />\n                  <meta\n                    property=\"og:type\"\n                    content=\"website\"\n                  />\n                  <meta\n                    property=\"og:title\"\n                    content=\"Indivisible\"\n                  />\n                  <meta\n                    property=\"og:url\"\n                    content=\"https://www.facebook.com/indivisibleguide/\"\n                  />\n                  <meta\n                    property=\"og:description\"\n                    content={data.campaignItem.facebookBody}\n                  />\n                  <meta\n                    property=\"og:image\"\n                    content={data.campaignItem.facebookImage}\n                  />\n                  <meta name=\"twitter:card\" content=\"summary_large_image\" />\n                  <meta\n                    name=\"twitter:site\"\n                    content=\"https://twitter.com/indivisibleteam\"\n                  />\n                  <meta name=\"twitter:url\" content=\"https://indivisible.org\" />\n                  <meta\n                    name=\"twitter:title\"\n                    content={\"Indivisible -\" + data.campaignItem.title}\n                  />\n                  <meta\n                    name=\"twitter:description\"\n                    content={data.campaignItem.twitterBody}\n                  />\n                  <meta\n                    name=\"twitter:image\"\n                    content={data.campaignItem.twitterImage}\n                  />\n                </Head>\n\n                <div\n                  className={\n                    this.state.shouldHide\n                      ? \"hidden frontEndHero\"\n                      : \"frontEndHero\"\n                  }\n                >\n                  <div className=\"heroLeft\">\n                    <h2>{data.campaignItem.title}</h2>\n                    <div\n                      dangerouslySetInnerHTML={{\n                        __html: data.campaignItem.callBody\n                      }}\n                    />\n                  </div>\n                  <div className=\"heroRight\">\n                    <h3>\n                      Fill out this form to get started. Providing your street address helps us target your call.\n                    </h3>\n                    <form onSubmit={this.connectSubmit}>\n                      <input\n                        type=\"hidden\"\n                        name=\"opt_in_path[]\"\n                        value=\"OP524334C35D99531FDB698DA8A9BBC181\"\n                      />\n                      {/* <input type=\"hidden\" name=\"redirect_to\" value=\"http://yoursite.com/your_submission_confirmation_page\" /> */}\n                      <input\n                        type=\"hidden\"\n                        name=\"mconnect\"\n                        // value=\"VO62798AD34DD5F773E028AD71DC139A9F\"\n                        tabIndex=\"-1\"\n                      />\n                      <input\n                        // name=\"person[street1]\"\n                        type=\"text\"\n                        onChange={this.handleChange}\n                        value={this.state.streetAddress}\n                        name=\"streetAddress\"\n                        required\n                        placeholder=\"Street Name\"\n                      />\n                      <input\n                        // name=\"person[postal_code]\"\n                        onChange={this.handleChange}\n                        value={this.state.postalCode}\n                        name=\"postalCode\"\n                        required\n                        type=\"text\"\n                        placeholder=\"ZIP\"\n                      />\n                      <input\n                        name=\"person[phone]\"\n                        type=\"number\"\n                        required\n                        placeholder=\"Mobile Number\"\n                      />\n                      <input type=\"submit\" value=\"Call Me\"  />\n                    </form>\n\n\n                    <h6>\n                      By providing your cell phone number, you agree to receive calls and texts about important updates, ways to take action, and information about events in your area from Indivisible, approximately 3 to 5 times a month. Message&amp; data rates may apply. Reply with STOP to quit receiving texts at any time.\n                    </h6>\n\n\n                    <ul>\n                      {/* {this.state.divisionItems.map(item => (\n                        console.log(item)\n                      ))} */}\n                    </ul>\n\n\n                    {/* <ul>\n                      {this.state.officialItems.map(item => (\n                        <li key={item.name}>\n                          {console.log(item.address)}\n                          {item.name}\n                          <br />\n                          {item.phones}\n                          <br />\n                          {item.channels[0].type}\n                          <img src={item.photoUrl} alt=\"repimage\" width=\"100%\" />\n\n                        </li>\n                      ))}\n                    </ul> */}\n                  </div>\n                </div>\n\n                <div\n                  className={\n                    this.state.shouldHide2\n                      ? \"stepTwoSection\"\n                      : \"hidden stepTwoSection\"\n                  }\n                >\n                  <div className=\"inner\">\n                    <h2>Your Phone Will Be Ringing Shortly...</h2>\n                    <h3>\n                      Please make sure you have your phone nearby, and that the\n                      volume is turned up.\n                    </h3>\n\n\n                    <MatchedScripts\n                      id={this.props.id}\n                      candidates={data.campaignItem.targetCandidates}\n                      matchedCand={this.state.officialItems}\n                      candParty={this.state.candidateParty}\n                      candState={this.state.candidateState}\n                    />\n\n\n                    <div className=\"repNameScript\">\n                      <h1>DEFAULT SCRIPT</h1>\n                      <div className=\"scriptContainer\">\n                        <div\n                          dangerouslySetInnerHTML={{\n                            __html: data.campaignItem.defaultScript\n                          }}\n                        />\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"imDone\">\n                    <div className=\"imDoneContainer\">\n                      <button\n                        onClick={e => {\n                          e.preventDefault();\n                          this.setState({ shouldHide: true });\n                          this.setState({ shouldHide2: false });\n                          this.setState({ shouldHide3: true });\n                        }}\n                      >\n                        I'm Done!\n                      </button>\n                      {/* <Link href=\"#\" >\n                      <a >\n                        I'm talking to a different person.\n                      </a>\n                    </Link> */}\n                    </div>\n                  </div>\n                </div>\n\n                <div\n                  className={\n                    this.state.shouldHide3\n                      ? \"stepThreeSection\"\n                      : \"hidden stepThreeSection\"\n                  }\n                >\n\n                  <div className=\"stepThreeContainer\">\n                    <h1>\n                      THANK <span>YOU!</span>\n                    </h1>\n\n                    <h2>\n                      <div\n                        dangerouslySetInnerHTML={{\n                          __html: data.campaignItem.thankYouTitle\n                        }}\n                      />\n                    </h2>\n\n                    <div\n                      dangerouslySetInnerHTML={{\n                        __html: data.campaignItem.thankYouMessage\n                      }}\n                    />\n\n                    <button\n                      onClick={e => {\n                        e.preventDefault();\n                        this.setState({ shouldHide: false });\n                        this.setState({ shouldHide2: false });\n                        this.setState({ shouldHide3: false });\n                      }}\n                    >\n                      Call Again\n                    </button>\n                  </div>\n                </div>\n\n                <form\n                  onSubmit={e => this.updateCampaignItem(e, updateCampaignItem)}\n                ></form>\n              </MainStyles>\n            </div>\n          );\n          }\n        }}\n      </Query>\n    );\n  }\n}\n\nexport default PreviewCampaignItem;\n"],"mappings":"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","sourceRoot":""}